<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Powerful Graph fused lasso Inference  • PGInference</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="Powerful Graph fused lasso Inference ">
<meta property="og:description" content="An implementation of powerful selective inference for graph fused lasso as described in Chen et al. (2021+)">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">PGInference</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/technical_details.html">Technical details</a>
</li>
<li>
  <a href="articles/Tutorials.html">Software tutorials</a>
</li>
<li>
  <a href="articles/real_data_example.html">Real data example</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="pginference-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#pginference-" class="anchor"></a>PGInference <img src="reference/figures/PGInference_sticker.png" align="right" width="150px">
</h1></div>
<div id="what-is-pginference" class="section level3">
<h3 class="hasAnchor">
<a href="#what-is-pginference" class="anchor"></a>What is PGInference?</h3>
<p><code>PGInference</code> is an <code>R</code> package for performing Powerful Graph fused lasso Inference.</p>
</div>
<div id="how-do-i-install-the-package" class="section level3">
<h3 class="hasAnchor">
<a href="#how-do-i-install-the-package" class="anchor"></a>How do I install the package?</h3>
<p>To download the PGInference package, use the code below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/">"devtools"</a></span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"yiqunchen/PGInference"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">PGInference</span><span class="op">)</span></code></pre></div>
</div>
<div id="why-do-we-need-pginference" class="section level3">
<h3 class="hasAnchor">
<a href="#why-do-we-need-pginference" class="anchor"></a>Why do we need PGInference?</h3>
<p>One of the most fundamental task in statistics is to test for a difference the means between two groups — comparing vaccine efficacy between treatment and control groups, detecting the shift in copy numbers in chromosomes, to name a few. Classical hypothesis tests (e.g., z-test when the group variance is known) control the selective Type I error (i.e., the probability of a false rejection, <em>given that</em> the null hypothesis is tested) when the groups are defined a priori. However, in practice, we often find ourselves testing hypotheses generated by the same data, which leads to (extremely) inflated Type I error.</p>
<p>As a concrete example, the graph fused lasso estimator is widely used in practice to reconstruct underlying signals that are <em>piecewise constant</em>. The resulting estimate can be segmented into a partition known as the <em>connected components</em>, regions within which the estimate takes on the same value. Suppose we want to test whether the means between two groups are the same, then we need to carefully craft new procedures in lieu of a z-test, because now the groups are <em>defined through data</em>.</p>
<p>To tackle this problem, Hyun et al. (2018) proposed the <span class="math inline"><em>p</em></span>-value <span class="math inline"><em>p</em><sub>Hyun</sub></span> by conditioning on all the intermediate outputs of the algorithm used to obtain the graph fused lasso estimator. While their proposal is computationally efficient, we note that <span class="math inline"><em>p</em><sub>Hyun</sub></span> conditions on too much information than what is necessary to come up with the hypothesis under consideration, therefore leading to (extremely) low power.</p>
<p>Building on the low power observation, we propose an alternative <span class="math inline"><em>p</em></span>-value <span class="math inline"><em>p</em><sub><em>C</em><sub>1</sub>, <em>C</em><sub>2</sub></sub></span> which conditions <em>only on the presence of two connected components being tested</em>. The resulting <span class="math inline"><em>p</em></span>-value will control the selective Type I error, while having higher power than <span class="math inline"><em>p</em><sub>Hyun</sub></span>. We demonstrate the increase in power in the figure below: in the leftmost panel, we plot the piecewise mean structure of the signal we are simulating from; in the middle panel, we see that under the null hypothesis, both <span class="math inline"><em>p</em><sub>Hyun</sub></span> and <span class="math inline"><em>p</em><sub><em>C</em><sub>1</sub>, <em>C</em><sub>2</sub></sub></span> control the selective Type I error, but the z-test <span class="math inline"><em>p</em><sub>Naive</sub> = ℙ(|<em>ν</em><sup>⊤</sup><em>Y</em>| ≥ |<em>ν</em><sup>⊤</sup><em>y</em>|)</span> leads to inflated selective Type I error; finally, we demonstrate that <span class="math inline"><em>p</em><sub><em>C</em><sub>1</sub>, <em>C</em><sub>2</sub></sub></span> has higher power than <span class="math inline"><em>p</em><sub>Hyun</sub></span> across all values of the effect size (<span class="math inline">|<em>ν</em><sup>⊤</sup><em>β</em>|/<em>σ</em></span>) considered.</p>
<p><img src="../man/figures/combined_two_d.png" alt="Figure 1: (a): The piecewise mean structure of \beta according to a two-dimensional grid graph. (b): Under the null hypothesis, both p_{\text{Hyun}} and p_{C_1,C_2} control the selective Type I error, but the z-test p_{\text{Naive}} = \mathbb{P}(|\nu^\top Y|\geq |\nu^\top y|) leads to inflated selective Type I error. (c): For a given value of the effect size (|\nu^\top\beta|/\sigma), p_{C_1,C_2} has higher power than p_{\text{Hyun}}. Power for both increases as a function of the effect size."></p>
</div>
<div id="link-to-additional-resources" class="section level3">
<h3 class="hasAnchor">
<a href="#link-to-additional-resources" class="anchor"></a>Link to additional resources</h3>
<ul>
<li>You can learn more about the technical details in our manuscript and in the <a href="https://yiqunchen.github.io/PGInference/articles/technical_details.html">technical details section</a>.</li>
<li>You can learn more about how to use our software in the <a href="https://yiqunchen.github.io/PGInference/articles/Tutorials.html">tutorials section</a>.</li>
<li>Finally, code and steps to reproduce the figures in our manuscript can be found in the GitHub repo <a href="https://github.com/yiqunchen/PGInference-experiments">https://github.com/yiqunchen/PGInference-experiments</a>.</li>
</ul>
</div>
<div id="citation" class="section level3">
<h3 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h3>
<p>If you use <code>PGInference</code> for your analysis, please cite our manuscript:</p>
<p>Chen YT, Jewell SW, Witten DM. (2021+) More powerful selective inference for the graph fused lasso.</p>
</div>
<div id="bug-reports--change-requests" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-reports--change-requests" class="anchor"></a>Bug Reports / Change Requests</h3>
<p>If you encounter a bug or would like to make a change request, please file it as an issue <a href="https://github.com/yiqunchen/PGInference/issues">here</a>.</p>
</div>
<div id="references" class="section level3">
<h3 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h3>
<p>Chen YT, Jewell SW, Witten DM. (2021+) More powerful selective inference for the graph fused lasso</p>
<p>Fithian W, Sun D, Taylor J. (2014) Optimal Inference After Model Selection. arXiv:1410.2597 [mathST].</p>
<p>Hyun S, G’Sell M, Tibshirani RJ. (2018) Exact post-selection inference for the generalized lasso path. Electron J Stat.</p>
<p>Lee JD, Sun DL, Sun Y, Taylor JE. Exact post-selection inference, with application to the lasso. Ann Stat. 2016;44(3):907-927. <a href="doi:10.1214/15-AOS1371" class="uri">doi:10.1214/15-AOS1371</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Yiqun Chen <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Yiqun Chen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
